{"ast":null,"code":"import formatErrorMessage from './formatErrorMessage';\nfunction isObj(o) {\n  return o != null && (typeof o === 'object' || typeof o == 'function');\n}\nfunction isPromiseLike(v) {\n  return v instanceof Promise || isObj(v) && typeof v.then === 'function';\n}\n/**\n * Create a data validator\n * @param data\n */\nexport function createValidator(data, name, label) {\n  return (value, rules) => {\n    for (let i = 0; i < rules.length; i += 1) {\n      const {\n        onValid,\n        errorMessage,\n        params,\n        isAsync\n      } = rules[i];\n      if (isAsync) continue;\n      const checkResult = onValid(value, data, name);\n      const errorMsg = typeof errorMessage === 'function' ? errorMessage() : errorMessage;\n      if (checkResult === false) {\n        return {\n          hasError: true,\n          errorMessage: formatErrorMessage(errorMsg, {\n            ...params,\n            name: label || (Array.isArray(name) ? name.join('.') : name)\n          })\n        };\n      } else if (isPromiseLike(checkResult)) {\n        throw new Error('synchronous validator had an async result, you should probably call \"checkAsync()\"');\n      } else if (typeof checkResult === 'object' && (checkResult.hasError || checkResult.array)) {\n        return checkResult;\n      }\n    }\n    return null;\n  };\n}\nexport default createValidator;","map":{"version":3,"names":["formatErrorMessage","isObj","o","isPromiseLike","v","Promise","then","createValidator","data","name","label","value","rules","i","length","onValid","errorMessage","params","isAsync","checkResult","errorMsg","hasError","Array","isArray","join","Error","array"],"sources":["C:\\Users\\lenovo\\OneDrive\\Documents\\local project\\platfoorm45_technical_challenge\\node_modules\\schema-typed\\src\\utils\\createValidator.ts"],"sourcesContent":["import { CheckResult, RuleType } from '../types';\nimport formatErrorMessage from './formatErrorMessage';\nfunction isObj(o: unknown): o is Record<PropertyKey, unknown> {\n  return o != null && (typeof o === 'object' || typeof o == 'function');\n}\nfunction isPromiseLike(v: unknown): v is Promise<unknown> {\n  return v instanceof Promise || (isObj(v) && typeof v.then === 'function');\n}\n/**\n * Create a data validator\n * @param data\n */\nexport function createValidator<V, D, E>(data?: D, name?: string | string[], label?: string) {\n  return (value: V, rules: RuleType<V, D, E>[]): CheckResult<E> | null => {\n    for (let i = 0; i < rules.length; i += 1) {\n      const { onValid, errorMessage, params, isAsync } = rules[i];\n      if (isAsync) continue;\n      const checkResult = onValid(value, data, name);\n      const errorMsg = typeof errorMessage === 'function' ? errorMessage() : errorMessage;\n\n      if (checkResult === false) {\n        return {\n          hasError: true,\n          errorMessage: formatErrorMessage<E>(errorMsg, {\n            ...params,\n            name: label || (Array.isArray(name) ? name.join('.') : name)\n          })\n        };\n      } else if (isPromiseLike(checkResult)) {\n        throw new Error(\n          'synchronous validator had an async result, you should probably call \"checkAsync()\"'\n        );\n      } else if (typeof checkResult === 'object' && (checkResult.hasError || checkResult.array)) {\n        return checkResult;\n      }\n    }\n\n    return null;\n  };\n}\n\nexport default createValidator;\n"],"mappings":"AACA,OAAOA,kBAAkB,MAAM,sBAAsB;AACrD,SAASC,KAAKA,CAACC,CAAU;EACvB,OAAOA,CAAC,IAAI,IAAI,KAAK,OAAOA,CAAC,KAAK,QAAQ,IAAI,OAAOA,CAAC,IAAI,UAAU,CAAC;AACvE;AACA,SAASC,aAAaA,CAACC,CAAU;EAC/B,OAAOA,CAAC,YAAYC,OAAO,IAAKJ,KAAK,CAACG,CAAC,CAAC,IAAI,OAAOA,CAAC,CAACE,IAAI,KAAK,UAAW;AAC3E;AACA;;;;AAIA,OAAM,SAAUC,eAAeA,CAAUC,IAAQ,EAAEC,IAAwB,EAAEC,KAAc;EACzF,OAAO,CAACC,KAAQ,EAAEC,KAA0B,KAA2B;IACrE,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,KAAK,CAACE,MAAM,EAAED,CAAC,IAAI,CAAC,EAAE;MACxC,MAAM;QAAEE,OAAO;QAAEC,YAAY;QAAEC,MAAM;QAAEC;MAAO,CAAE,GAAGN,KAAK,CAACC,CAAC,CAAC;MAC3D,IAAIK,OAAO,EAAE;MACb,MAAMC,WAAW,GAAGJ,OAAO,CAACJ,KAAK,EAAEH,IAAI,EAAEC,IAAI,CAAC;MAC9C,MAAMW,QAAQ,GAAG,OAAOJ,YAAY,KAAK,UAAU,GAAGA,YAAY,EAAE,GAAGA,YAAY;MAEnF,IAAIG,WAAW,KAAK,KAAK,EAAE;QACzB,OAAO;UACLE,QAAQ,EAAE,IAAI;UACdL,YAAY,EAAEhB,kBAAkB,CAAIoB,QAAQ,EAAE;YAC5C,GAAGH,MAAM;YACTR,IAAI,EAAEC,KAAK,KAAKY,KAAK,CAACC,OAAO,CAACd,IAAI,CAAC,GAAGA,IAAI,CAACe,IAAI,CAAC,GAAG,CAAC,GAAGf,IAAI;WAC5D;SACF;OACF,MAAM,IAAIN,aAAa,CAACgB,WAAW,CAAC,EAAE;QACrC,MAAM,IAAIM,KAAK,CACb,oFAAoF,CACrF;OACF,MAAM,IAAI,OAAON,WAAW,KAAK,QAAQ,KAAKA,WAAW,CAACE,QAAQ,IAAIF,WAAW,CAACO,KAAK,CAAC,EAAE;QACzF,OAAOP,WAAW;;;IAItB,OAAO,IAAI;EACb,CAAC;AACH;AAEA,eAAeZ,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}